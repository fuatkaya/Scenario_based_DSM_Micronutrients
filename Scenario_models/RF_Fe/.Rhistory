##Sentinel
KhavrSVR_Micro_modeltune_Fe_RS_Sentinel <- tune(svm, Fe ~ Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi +
ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr,
data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_RS_Sentinel
# Internal validation
KhavrSVR_Micro_Fe_RS_Sentinel_Internal <- predict(KhavrSVR_Micro_Fe_RS_Sentinel, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Sentinel_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Sentinel_External <- predict(KhavrSVR_Micro_Fe_RS_Sentinel, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Sentinel_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_RS_Sentinel_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Sentinel_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_RS_Sentinel_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Sentinel_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
##Landsat+Sentinel
KhavrSVR_Micro_modeltune_Fe_RS_Landsat_Sentinel <- tune(svm, Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance +
ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi +
ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr,
data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_RS_Landsat_Sentinel
KhavrSVR_Micro_Fe_RS_Landsat_Sentinel <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance +
ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi +
ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr
,data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=0.25, gamma=0.25)
KhavrSVR_Micro_Fe_RS_Landsat_Sentinel
# Internal validation
KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_Internal <- predict(KhavrSVR_Micro_Fe_RS_Landsat_Sentinel, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_Internal
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_External <- predict(KhavrSVR_Micro_Fe_RS_Landsat_Sentinel, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Landsat_Sentinel_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
##RS+Topographic
KhavrSVR_Micro_modeltune_Fe_RS_Topographic <- tune(svm, Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance +
ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi +
ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr, data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_RS_Topographic
KhavrSVR_Micro_Fe_RS_Topographic <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance +
ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi +
ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=0.125, gamma=0.25)
KhavrSVR_Micro_Fe_RS_Topographic
# Internal validation
KhavrSVR_Micro_Fe_RS_Topographic_Internal <- predict(KhavrSVR_Micro_Fe_RS_Topographic, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
KhavrSVR_Micro_Fe_RS_Topographic_Internal
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Topographic_External <- predict(KhavrSVR_Micro_Fe_RS_Topographic, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
##RS+Topographic+Climate
KhavrSVR_Micro_modeltune_Fe_RS_Topographic_Climate <- tune(svm, Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr, data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_RS_Topographic_Climate
KhavrSVR_Micro_Fe_RS_Topographic_Climate <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=4, gamma=0.25)
KhavrSVR_Micro_Fe_RS_Topographic_Climate
# Internal validation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_External <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_Climate_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_Climate_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal ,  plot.it = TRUE)
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_Climate_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_Climate_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
###RS+Topographic+Climate+Soil
KhavrSVR_Micro_modeltune_Fe_RS_Topographic_Climate_Soil <- tune(svm, Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr + Sand_khavr, data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_RS_Topographic_Climate_Soil
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr + Sand_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=4, gamma=0.25)
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil
# Internal validation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External,  plot.it = TRUE)
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr + Sand_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=2, gamma=0.25)
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil
# Internal validation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External,  plot.it = TRUE)
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr + Sand_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=1, gamma=0.25)
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil
# Internal validation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External,  plot.it = TRUE)
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B08A_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr + Sand_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=4, gamma=0.25)
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil
# Internal validation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External <- predict(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_RS_Topographic_Climate_Soil_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
###Topographic
KhavrSVR_Micro_modeltune_Fe_Topographic <- tune(svm, Fe ~ FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr
, data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_Topographic
KhavrSVR_Micro_Fe_Topographic <- svm(Fe ~ FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr
, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=0.25, gamma=0.25)
KhavrSVR_Micro_Fe_Topographic
# Internal validation
KhavrSVR_Micro_Fe_Topographic_Internal <- predict(KhavrSVR_Micro_Fe_Topographic, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Topographic_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Topographic_External <- predict(KhavrSVR_Micro_Fe_Topographic, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Topographic_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_Topographic_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Topographic_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_Topographic_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Topographic_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
###Climate
KhavrSVR_Micro_modeltune_Fe_Climate <- tune(svm, Fe ~  srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr, data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_Climate
KhavrSVR_Micro_Fe_Climate <- svm(Fe ~  srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=16, gamma=0.5)
KhavrSVR_Micro_Fe_Climate
# Internal validation
KhavrSVR_Micro_Fe_Climate_Internal <- predict(KhavrSVR_Micro_Fe_Climate, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Climate_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Climate_External <- predict(KhavrSVR_Micro_Fe_Climate, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Climate_External,  plot.it = TRUE)
KhavrSVR_Micro_Fe_Climate <- svm(Fe ~  srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=16, gamma=0.5)
KhavrSVR_Micro_Fe_Climate
# Internal validation
KhavrSVR_Micro_Fe_Climate_Internal <- predict(KhavrSVR_Micro_Fe_Climate, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Climate_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Climate_External <- predict(KhavrSVR_Micro_Fe_Climate, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Climate_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_Climate_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Climate_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_Climate_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Climate_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
###Soil
KhavrSVR_Micro_modeltune_Fe_Soil <- tune(svm, Fe ~ b2_reflectance + Clay_khavr + pH_khavr + Sand_khavr,data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
###Soil
KhavrSVR_Micro_modeltune_Fe_Soil <- tune(svm, Fe ~ b2_reflectance + Clay_khavr + pH_khavr + Sand_khavr,data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_Soil
KhavrSVR_Micro_Fe_Soil <- svm(Fe ~ b2_reflectance + Clay_khavr + pH_khavr + Sand_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=2, gamma=1)
KhavrSVR_Micro_modeltune_Fe_Soil
KhavrSVR_Micro_Fe_Soil <- svm(Fe ~ b2_reflectance + Clay_khavr + pH_khavr + Sand_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=2, gamma=1)
KhavrSVR_Micro_Fe_Soil
# Internal validation
KhavrSVR_Micro_Fe_Soil_Internal <- predict(KhavrSVR_Micro_Fe_Soil, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Soil_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Soil_External <- predict(KhavrSVR_Micro_Fe_Soil, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Soil_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_Soil_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Soil_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_Soil_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Soil_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
#####Recursive Feature Elimination
KhavrSVR_Micro_modeltune_Fe_Rec_Fea_Elimination <- tune(svm, Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, method ="rf", data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
#####Recursive Feature Elimination
KhavrSVR_Micro_modeltune_Fe_Rec_Fea_Elimination <- tune(svm, Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset,
kernel = "radial",
ranges = list(gamma= 2^(-2:2), cost = 2^(-4:10)),
tune.control=tune.control(cross = 5))
KhavrSVR_Micro_modeltune_Fe_Rec_Fea_Elimination
KhavrRF_Micro_Fe_Rec_Fea_Elimination <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=4, gamma=0.25)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=4, gamma=0.25)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination
# Internal validation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal ,  plot.it = TRUE)
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External,  plot.it = TRUE)
#training
nrmse(KhavrRF_Micro_Fe_Rec_Fea_Elimination_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
#training
nrmse(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
KhavrSVR_Micro_Fe_Rec_Fea_Elimination <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="linear", cost=4, gamma=0.25)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination
# Internal validation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External,  plot.it = TRUE)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=4, gamma=0.25)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination
# Internal validation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal ,  plot.it = TRUE)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=6, gamma=0.25)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination
# Internal validation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External,  plot.it = TRUE)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=3, gamma=0.25)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination
# Internal validation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External,  plot.it = TRUE)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination <- svm(Fe ~ b2_reflectance + b3_reflectance + b4_reflectance + b5_reflectance + b6_reflectance + b7_reflectance + ci_mean_kh + gndvi_mean_kh + ndvi_mean_kh + satind_mean_kh + sgsi_mean_kh +
Sen_B02_30m_aoi + Sen_B03_Mean_30m_aoi + Sen_B04_Mean_30m_aoi + Sen_B05_Mean_30m_aoi + Sen_B06_Mean_30m_aoi + Sen_B07_Mean_30m_aoi + Sen_B08_Mean_30m_aoi + Sen_B11_Mean_30m_aoi + Sen_B12_Mean_30m_aoi + ClayInd_Mean_Sentinel_khavr + GNDVI_Mean_Sentinel_khavr + MSAVI2_Mean_Sentinel_khavr + NDVI_Mean_Sentinel_khavr + Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr +
Clay_khavr + pH_khavr, data = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ], kernel="radial", cost=1, gamma=0.25)
KhavrSVR_Micro_Fe_Rec_Fea_Elimination
# Internal validation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[Training_SVR_Micro_scenario, ])
goof(observed = SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External <- predict(KhavrSVR_Micro_Fe_Rec_Fea_Elimination, newdata = SVR_Micro_Scenario_models_dataset[-Training_SVR_Micro_scenario, ])
goof(observed =  SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario], predicted = KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External,  plot.it = TRUE)
#training
nrmse(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_Internal, SVR_Micro_Scenario_models_dataset$Fe[Training_SVR_Micro_scenario])
##testing
nrmse(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
MAPE(KhavrSVR_Micro_Fe_Rec_Fea_Elimination_External, SVR_Micro_Scenario_models_dataset$Fe[-Training_SVR_Micro_scenario])
library(sp)
library(raster)
library(rgdal)
library(ithir)
library(MASS)
library(randomForest)
library(caret)
library(ggplot2)
library(rasterVis)
library(lattice)
library(latticeExtra)
RF_Micro_Scenario_models_dataset <-read.csv(file.choose(),header =T, sep = ",")
RF_Micro_Scenario_models_dataset <-  as.data.frame(RF_Micro_Scenario_models_dataset)
View(RF_Micro_Scenario_models_dataset)
str(RF_Micro_Scenario_models_dataset)
set.seed(2021)
Training_RF_Micro_scenario <- sample(nrow(RF_Micro_Scenario_models_dataset), 0.7 * nrow(RF_Micro_Scenario_models_dataset))
str(Training_RF_Micro_scenario)
###tuning_Fe
ctrl_Micro_rf <- trainControl(method= "repeatedcv", number = 5, repeats = 3, search = "random")
###eXPERT OPİNİON AND ıf COVARİATE analysis
KhavrRF_Micro_modeltune_Fe_expert <- train(Fe ~ b2_reflectance + b5_reflectance  + ci_mean_kh +
Sen_B08_Mean_30m_aoi + GNDVI_Mean_Sentinel_khavr +  Saturation_Mean_Sentinel_khavr + SGSI_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr, method ="rf", data = RF_Micro_Scenario_models_dataset, trainControl=ctrl_Micro_rf)
KhavrRF_Micro_modeltune_Fe_expert
plot(KhavrRF_Micro_modeltune_Fe_expert)
###eXPERT OPİNİON AND ıf COVARİATE analysis
KhavrRF_Micro_modeltune_Fe_expert <- train(Fe ~ b2_reflectance + b5_reflectance  + ci_mean_kh +
Sen_B08_Mean_30m_aoi + GNDVI_Mean_Sentinel_khavr +  Saturation_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr, method ="rf", data = RF_Micro_Scenario_models_dataset, trainControl=ctrl_Micro_rf)
KhavrRF_Micro_modeltune_Fe_expert
plot(KhavrRF_Micro_modeltune_Fe_expert)
KhavrRF_Micro_Fe_expert <- randomForest(Fe ~ b5_reflectance  + ci_mean_kh +
Sen_B08_Mean_30m_aoi + GNDVI_Mean_Sentinel_khavr +  Saturation_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr
, method ="rf", data = RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], mtry = 2, ntree = 500)
KhavrRF_Micro_Fe_expert
plot(KhavrRF_Micro_Fe_expert)
# Internal validation
KhavrRF_Micro_Fe_expert_Internal <- predict(KhavrRF_Micro_Fe_expert, newdata = RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ])
KhavrRF_Micro_Fe_expert_Internal
goof(observed = RF_Micro_Scenario_models_dataset$Fe[Training_RF_Micro_scenario], predicted = KhavrRF_Micro_Fe_expert_Internal ,  plot.it = TRUE)
# externalvalidation
KhavrRF_Micro_Fe_expert__External <- predict(KhavrRF_Micro_Fe_expert, newdata = RF_Micro_Scenario_models_dataset[-Training_RF_Micro_scenario, ])
goof(observed =  RF_Micro_Scenario_models_dataset$Fe[-Training_RF_Micro_scenario], predicted = KhavrRF_Micro_Fe_expert__External,  plot.it = TRUE)
#training
nrmse(KhavrRF_Micro_Fe_expert_Internal, RF_Micro_Scenario_models_dataset$Fe[Training_RF_Micro_scenario])
library(hydroGOF)
library(PerformanceAnalytics)
library(MLmetrics)
#training
nrmse(KhavrRF_Micro_Fe_expert_Internal, RF_Micro_Scenario_models_dataset$Fe[Training_RF_Micro_scenario])
MAPE(KhavrRF_Micro_Fe_expert_Internal, RF_Micro_Scenario_models_dataset$Fe[Training_RF_Micro_scenario])
##testing
nrmse(KhavrRF_Micro_Fe_expert__External, RF_Micro_Scenario_models_dataset$Fe[-Training_RF_Micro_scenario])
MAPE(KhavrRF_Micro_Fe_expert__External, RF_Micro_Scenario_models_dataset$Fe[-Training_RF_Micro_scenario])
install.packages("openair")
library(openair)
library(openair)
library(openair)
library(dplyr)
library(openair)
install.packages("dplyr")
install.packages("dplyr")
library(openair)
library(dplyr)
library(openair)
install.packages("dplyr")
library(openair)
packageVersion("dplyr")
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
library(openair)
TaylorDiagram( mydata, obs = "obs", mod = "mod", group = NULL,
type = "default", normalise = FALSE, cols = "brewer1",
rms.col = "darkgoldenrod", cor.col = "black", arrow.lwd = 3,
annotate = "centred\nRMS error", key = TRUE,
key.title = group, key.columns = 1, key.pos = "right", strip = TRUE, auto.text = TRUE,
)
openair::TaylorDiagram( mydata, obs = "obs", mod = "mod", group = NULL,
type = "default", normalise = FALSE, cols = "brewer1",
rms.col = "darkgoldenrod", cor.col = "black", arrow.lwd = 3,
annotate = "centred\nRMS error", key = TRUE,
key.title = group, key.columns = 1, key.pos = "right", strip = TRUE, auto.text = TRUE,
)
remove.packages("dplyr")
install.packages("dplyr")
devtools::install_github("dplyr")
####Taylor and Hexbin graph
# internalvalidation
KhavrRF_Micro_Fe_expert_Internal_TH <- predict(KhavrRF_Micro_Fe_expert, newdata = RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], model = "calibration")
#################EXPERT OPINION AND VIF ############################
library(randomForest)
library(sp)
library(raster)
library(rgdal)
library(ithir)
library(MASS)
library(randomForest)
library(caret)
library(ggplot2)
library(rasterVis)
library(lattice)
library(latticeExtra)
KhavrRF_Micro_Fe_expert <- randomForest(Fe ~ b5_reflectance  + ci_mean_kh +
Sen_B08_Mean_30m_aoi + GNDVI_Mean_Sentinel_khavr +  Saturation_Mean_Sentinel_khavr +
FlowAcc_kh + PlanCur_kh + ProflCur_kh + slope_kh + spi_kh + Twi_kh + aoi_dem_clip_khavr +
srad_khavr + bio_15_khavr + bio_12_khavr + bio_1_khavr
, method ="rf", data = RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], mtry = 2, ntree = 250, importance = TRUE)
####Taylor and Hexbin graph
# internalvalidation
KhavrRF_Micro_Fe_expert_Internal_TH <- predict(KhavrRF_Micro_Fe_expert, newdata = RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], model = "calibration")
View(KhavrRF_Micro_Fe_expert_Internal_TH)
####Taylor and Hexbin graph
# internalvalidation
KhavrRF_Micro_Fe_expert_Internal_Pred <- predict(KhavrRF_Micro_Fe_expert, newdata = RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], model = "calibration")
View(KhavrRF_Micro_Fe_expert_Internal_Pred)
KhavrRF_Micro_Fe_expert_Internal_Obs <- RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ]
View(KhavrRF_Micro_Fe_expert_Internal_Pred)
View(KhavrRF_Micro_Fe_expert_Internal_Obs)
KhavrRF_Micro_Fe_expert_Internal_Obs <- RF_Micro_Scenario_models_dataset$Fe[Training_RF_Micro_scenario, ]
KhavrRF_Micro_Fe_expert_Internal_Obs <- as.dataframe(RF_Micro_Scenario_models_dataset$Fe[Training_RF_Micro_scenario, ])
KhavrRF_Micro_Fe_expert_Internal_Obs <- as.data.frame(RF_Micro_Scenario_models_dataset$Fe[Training_RF_Micro_scenario, ])
KhavrRF_Micro_Fe_expert_Internal_Obs <- as.data.frame(RF_Micro_Scenario_models_dataset$Fe[, Training_RF_Micro_scenario])
View(KhavrRF_Micro_Fe_expert_Internal_Pred)
KhavrRF_Micro_Fe_expert_Internal_Obs <- subset(RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], select= c(Fe))
View(KhavrRF_Micro_Fe_expert_Internal_Obs)
####Taylor and Hexbin graph
# internalvalidation
KhavrRF_Micro_Fe_expert_Internal_Pred <- predict(KhavrRF_Micro_Fe_expert, newdata = RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], model = "predicted")
KhavrRF_Micro_Fe_expert_Internal_Obs <- subset(RF_Micro_Scenario_models_dataset[Training_RF_Micro_scenario, ], select= c(Fe), model = "observed")
View(KhavrRF_Micro_Fe_expert_Internal_Obs)
###Birlestir
KhavrRF_Micro_Fe_expert_Cal <- rbind(KhavrRF_Micro_Fe_expert_Internal_Pred, KhavrRF_Micro_Fe_expert_Internal_Obs)
View(KhavrRF_Micro_Fe_expert_Cal)
KhavrRF_Micro_Fe_expert_Cal_col <- cbind(KhavrRF_Micro_Fe_expert_Internal_Pred, KhavrRF_Micro_Fe_expert_Internal_Obs)
View(KhavrRF_Micro_Fe_expert_Cal_col)
colnames(KhavrRF_Micro_Fe_expert_Cal_col) <- c("Predicted","Observed")
View(KhavrRF_Micro_Fe_expert_Cal_col)
scatterPlot(KhavrRF_Micro_Fe_expert_Cal_col, x ="Observed" , y = "Predicted",xlab=10, ylab=10,method = "hexbin",mod.line=T,auto.text=F, col = "jet", xbin = 30)
write.table(KhavrRF_Micro_Fe_expert_Cal_col, "KhavrRF_Micro_Fe_expert_Internal_column_merge.txt", sep = ",")
setwd("D:/Ali keshavarzi/Data1/Micro_elements/Scenario_models/RF_Fe")
